<!DOCTYPE html><html lang="en,default"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/avatar.jpg"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/animate-css/animate.min.css"><script class="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"hanielxx.com",root:"/",scheme:"Mala",version:"8.0.0-rc.4",exturl:!1,sidebar:{position:"right",display:"always",padding:18,offset:12},copycode:!0,bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"buttons",active:"disqus",storage:!0,lazyload:!1,nav:null,activeClass:"disqus"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"fadeInDown",post_body:"fadeInDown",coll_header:"fadeInLeft",sidebar:"fadeInUp"}},prism:!1,path:"search.xml"}</script><meta name="description" content="遇到一个聚类问题，感觉可以建模到GNN上面。记录一下问题和思路。包括基于Graph的聚类：Chinese Whisper、Spectral Cluster，基于GNN的聚类：基于GCN、CDP(ECCV2018)、DAEGC(IJCAI2019), AGC(IJCAI2019)"><meta property="og:type" content="article"><meta property="og:title" content="GNN和图聚类"><meta property="og:url" content="https://hanielxx.com/MachineLearning/2021-05-09-gnn-graph-clustering"><meta property="og:site_name" content="Catch Your Dream"><meta property="og:description" content="遇到一个聚类问题，感觉可以建模到GNN上面。记录一下问题和思路。包括基于Graph的聚类：Chinese Whisper、Spectral Cluster，基于GNN的聚类：基于GCN、CDP(ECCV2018)、DAEGC(IJCAI2019), AGC(IJCAI2019)"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/0nS2HD.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/px7w07.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/eTmcmA.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/rpF8Yi.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/8nzn56.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/J5TpAk.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/MGUaZE.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/MwcbDs.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/fYsPmB.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/in0VDA.png"><meta property="article:published_time" content="2021-05-09T05:11:01.000Z"><meta property="article:modified_time" content="2021-05-25T15:36:53.753Z"><meta property="article:author" content="Hanielxx"><meta property="article:tag" content="DeepLearning"><meta property="article:tag" content="Clustering"><meta property="article:tag" content="Graph"><meta property="article:tag" content="GNN"><meta property="article:tag" content="UnstructuredData"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/0nS2HD.png"><link rel="canonical" href="https://hanielxx.com/MachineLearning/2021-05-09-gnn-graph-clustering.html"><script class="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>GNN和图聚类 | Catch Your Dream</title><noscript><style>body{margin-top:2rem}.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header,.use-motion .sidebar{visibility:visible}.use-motion .footer,.use-motion .header,.use-motion .site-brand-container .toggle{opacity:initial}.use-motion .custom-logo-image,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line{transform:scaleX(1)}.search-pop-overlay,.sidebar-nav{display:none}.sidebar-panel{display:block}</style></noscript><style>mjx-container[jax=SVG]{direction:ltr}mjx-container[jax=SVG]>svg{overflow:visible}mjx-container[jax=SVG]>svg a{fill:#00f;stroke:#00f}mjx-container[jax=SVG][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=SVG][justify=left]{text-align:left}mjx-container[jax=SVG][justify=right]{text-align:right}g[data-mml-node=merror]>g{fill:red;stroke:red}g[data-mml-node=merror]>rect[data-background]{fill:#ff0;stroke:none}g[data-mml-node=mtable]>line[data-line]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>rect[data-frame]{stroke-width:70px;fill:none}g[data-mml-node=mtable]>.mjx-dashed{stroke-dasharray:140}g[data-mml-node=mtable]>.mjx-dotted{stroke-linecap:round;stroke-dasharray:0,140}g[data-mml-node=mtable]>svg{overflow:visible}[jax=SVG] mjx-tool{display:inline-block;position:relative;width:0;height:0}[jax=SVG] mjx-tool>mjx-tip{position:absolute;top:0;left:0}mjx-tool>mjx-tip{display:inline-block;padding:.2em;border:1px solid #888;font-size:70%;background-color:#f8f8f8;color:#000;box-shadow:2px 2px 5px #aaa}g[data-mml-node=maction][data-toggle]{cursor:pointer}mjx-status{display:block;position:fixed;left:1em;bottom:1em;min-width:25%;padding:.2em .4em;border:1px solid #888;font-size:90%;background-color:#f8f8f8;color:#000}foreignObject[data-mjx-xml]{font-family:initial;line-height:normal;overflow:visible}.MathJax path{stroke-width:3}mjx-container[display=true]{overflow:auto hidden}mjx-container[display=true]+br{display:none}</style><link rel="alternate" href="/atom.xml" title="Catch Your Dream" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">Catch Your Dream</h1><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-algorithm"><a href="/tags/Algorithm/" rel="section"><i class="fa fa-code fa-fw"></i>Algorithm</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><section class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#基于Graph"><span class="nav-number">1.</span> <span class="nav-text">基于Graph</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Chinese-Whisper"><span class="nav-number">1.1.</span> <span class="nav-text">Chinese Whisper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#谱聚类spectral-clustering"><span class="nav-number">1.2.</span> <span class="nav-text">谱聚类spectral clustering</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于GNN"><span class="nav-number">2.</span> <span class="nav-text">基于GNN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基于GCN聚类"><span class="nav-number">2.1.</span> <span class="nav-text">基于GCN聚类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CDP-ECCV2018"><span class="nav-number">2.2.</span> <span class="nav-text">CDP(ECCV2018)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DAEGC-IJCAI2019"><span class="nav-number">2.3.</span> <span class="nav-text">DAEGC(IJCAI2019)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AGC-IJCAI2019"><span class="nav-number">2.4.</span> <span class="nav-text">AGC(IJCAI2019)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#思路"><span class="nav-number">3.</span> <span class="nav-text">思路</span></a></li></ol></div></section><section class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Hanielxx" src="/avatar.jpg"><p class="site-author-name" itemprop="name">Hanielxx</p><div class="site-description" itemprop="description">Hanielxx | Blog</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">124</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">177</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/HanielF" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;HanielF" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:hanielxx@outlook.com" title="E-Mail → mailto:hanielxx@outlook.com" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div></section></div></aside><div id="sidebar-dimmer"></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/HanielF" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="external nofollow noopener noreferrer" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><noscript><div id="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://hanielxx.com/MachineLearning/2021-05-09-gnn-graph-clustering"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/avatar.jpg"><meta itemprop="name" content="Hanielxx"><meta itemprop="description" content="Hanielxx | Blog"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Catch Your Dream"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">GNN和图聚类</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-05-09 13:11:01" itemprop="dateCreated datePublished" datetime="2021-05-09T13:11:01+08:00">2021-05-09</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2021-05-25 23:36:53" itemprop="dateModified" datetime="2021-05-25T23:36:53+08:00">2021-05-25</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/MachineLearning/" itemprop="url" rel="index"><span itemprop="name">MachineLearning</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Disqus: </span><a title="disqus" href="/MachineLearning/2021-05-09-gnn-graph-clustering#disqus_thread" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="MachineLearning/2021-05-09-gnn-graph-clustering.html" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span>6.6k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span>17 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><meta name="referrer" content="no-referrer"><div class="note info"><p>遇到一个聚类问题，感觉可以建模到GNN上面。记录一下问题和思路。</p><p>包括基于Graph的聚类：Chinese Whisper、Spectral Cluster，基于GNN的聚类：基于GCN、CDP(ECCV2018)、DAEGC(IJCAI2019), AGC(IJCAI2019)</p><a id="more"></a><p><strong>特点：</strong></p><ol><li>无监督的多模态数据</li><li>聚类成N个类别，这个类别数目不确定</li><li>会有新节点加入</li><li>如果训练端到端的模型，成本可能很高，每次都得聚类一次</li><li>图的数量很大，并且大小不确定，从几十到大几百上千不等</li><li>node之间的link很稀疏并且是顺序连接，部分连边可能并不代表真实的联系</li><li>如果是自己设置图的连边，那阈值也都不同，如果不建模到图上，就不存在连边问题，直接是一堆样本进行聚类</li><li>或许可以用集数作为连边信息，只要是集数连着就有边，没有集数就没有边，semi-supervised</li></ol><p><strong>几个方向：</strong></p><ol><li><del>Link Prediction</del><ol><li>不适用，因为这个是在有命名实体的情况下预测连接</li><li>想想知识图谱</li></ol></li><li>Graph Clustering<ol><li>(DAEGC)《Attributed Graph Clustering via Adaptive Graph Convolution》</li><li>比较像</li></ol></li><li>Community Detection<ol><li>发现共享相似属性或功能的顶点组来了解网络数据</li><li>有很多基于顶点embedding的聚类算法</li><li>《CommunityGAN: Community Detection with Generative Adversarial Nets》</li><li>《GEMSEC: Graph Embedding with Self Clustering》这个不太行，nodes are clustered into a fixed number of groups，而且需要图结构。但是，它是在sequence based graph（拥有相似邻居的节点在空间上更接近）上做的</li></ol></li><li><del>Graph Reconstruction</del><ol><li>《Multi-View Self-Constructing Graph Convolutional Networks With Adaptive Class Weighting Loss for Semantic Segmentation》直接通过输入feature构建基础图，而不是依赖先验知识。这居然是用在图像的语义分割上…</li></ol></li><li><del>dynamic graph clustering</del><ol><li>《Interpretable Clustering on Dynamic Graphs with Recurrent Graph Neural Networks》用一个动态随机块模型来捕获这些变化，并提出一种基于衰减的简单聚类算法，该算法基于节点之间的加权连接对节点进行聚类，其中权重随时间以固定速率降低。还基于半监督图聚类提出了两种新的RNN-GCN结构</li><li>节点之间的连接以及节点的聚类成员身份可能会随时间而变化，但是并不是新加入节点，和合集的场景不太一样</li></ol></li><li>或许不应该focus在端到端的模型上面，应该看看传统的机器学习算法，毕竟可以得到确定性的结果同时迭代新的数据。</li><li>可以利用上正则的匹配结果，作为部分label进行semi-supervised learning，这样的目的其实是为了提高召回，而不是precision</li></ol></div><h2 id="基于Graph"><a href="#基于Graph" class="headerlink" title="基于Graph"></a>基于Graph</h2><h3 id="Chinese-Whisper"><a href="#Chinese-Whisper" class="headerlink" title="Chinese Whisper"></a>Chinese Whisper</h3><p>基于图的聚类算法，代表性的基础算法是Chinese Whisper</p><ul><li>初始化：将所有的样本点初始化为不同的类，自下而上的进行聚类</li><li>建图：<strong>根据样本点之间的距离建图</strong>，距离较远的两个点之间的边权重值较低，而距离较近的两个点之间的边权重值较高。是否连边需要<strong>设置阈值</strong></li><li>迭代：<ol><li>随机选取一个节点i开始，在其相连节点中选取边权重最大者j, 并将i归为节点j类（若相连节点中有多个节点属于同一类，则将这些权重相加再做比较）</li><li>遍历所有节点后，重复迭代至满足迭代次数</li></ol></li><li>优点：不用设定k，只需指定相似度阈值</li><li>缺点：<ol><li>对向量的要求度较高，需要向量能够增大类间距离，减小类内距离</li><li>由于随机初始化，每次聚类的结果有可能不一致</li></ol></li><li>优化<ol><li>CW需要自行设置相似度阈值，且该阈值敏感度较高，后续优化方向是自动选择阈值</li><li>Linkage Based Face Clustering via GCN（CVPR2019）</li></ol></li></ul><h3 id="谱聚类spectral-clustering"><a href="#谱聚类spectral-clustering" class="headerlink" title="谱聚类spectral clustering"></a>谱聚类spectral clustering</h3><ul><li><a href="https://www.cnblogs.com/pinard/p/6221564.html" target="_blank" rel="external nofollow noopener noreferrer">刘建平-谱聚类原理</a></li><li>解决的问题是kmeans中无法对非欧式空间的分布进行聚类的问题，主要原理是对聚类数据进行变换，然后进行k-means聚类，之后再还原到原空间。</li><li>算法思路：它的主要思想是把所有的数据看做空间中的点，这些点之间可以用边连接起来。距离较远的两个点之间的边权重值较低，而距离较近的两个点之间的边权重值较高，通过对所有数据点组成的图进行切图，让切图后不同的<strong>子图间边权重和尽可能的低</strong>，而<strong>子图内的边权重和尽可能的高</strong>，从而达到聚类的目的。</li><li>度矩阵<ul><li>度$d_i$定义为和它相连的所有边的权重之和，对于没有边连接的两个点之间$w=0$。权重可以自己输入</li><li>得到$nxn$的度矩阵𝐷，是个对角阵</li></ul></li><li>邻接矩阵<ul><li>所有点之间的权重值，我们可以得到图的邻接矩阵</li><li>$nxn$，第i行的第j个值对应我们的权重 $w_{ij}$</li><li>通过样本点距离度量的相似矩阵𝑆来获得邻接矩阵𝑊。构建邻接矩阵𝑊的方法有三类。<ul><li>𝜖-邻近法：<ul><li>用节点间欧式距离和阈值𝜖比，取 $w_{ij} = \epsilon\ if\ dis\ &gt;\ \epsilon\ else\ 0$</li><li>两点间的权重要不就是𝜖,要不就是0，距离远近度量很不精确，因此在实际应用中，我们很少使用𝜖-邻近法。</li></ul></li><li>K邻近法：<ul><li>KNN算法遍历所有的样本点，取每个样本最近的k个点作为近邻。只有距离最近的k个点之间的 $w&gt;0$，图中用的RBF高斯核</li><li>RBF高斯核，$K(x,x’) = \exp -\frac{||x-x’||_2^2}{2\sigma^2}$ 值随距离增大而减小，介于0-1之间。也会一种现成的相似性度量表示</li><li>重构之后的邻接矩阵W非对称，但算法需要对称邻接矩阵</li><li><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/0nS2HD.png" alt="0nS2HD"></li></ul></li><li>全连接法：<ul><li>所有的点之间的权重值都大于0，因此称之为全连接法</li><li>可以选择不同的核函数来定义边权重，常用的有多项式核函数，高斯核函数和Sigmoid核函数。最常用的是高斯核函数RBF，此时相似矩阵和邻接矩阵相同</li><li>$w_{ij} = \exp -\frac{||x_i - x_j||^2_2}{2\sigma ^2}$</li></ul></li></ul></li></ul></li><li>拉普拉斯矩阵<ul><li>$L = D - W$，其中D是度矩阵对角阵， W是邻接矩阵</li><li>L是对称矩阵，这可以由𝐷和𝑊都是对称矩阵而得</li><li>L是对称矩阵，则它的所有的特征值都是实数</li><li>对于任意的向量 $f$，$f^T L f = \sum_{i,j=1}^n w_{ij}(f_i-f_j)^2$。可以通过 $f^T L f = f^T D f - f^T W f$得到</li><li>L是半正定的，且对应的n个实数特征值都大于等于0</li><li>L是半正定的，且对应的n个实数特征值都大于等于0，即 $0 = \lambda_1 \le \lambda_2 \le .. \lambda_n$， 且最小的特征值为0</li></ul></li><li>子图<ul><li>点集$V$的的一个子集$A \in V$</li><li>$vol(A) := \sum_{i\in A} d_i$</li></ul></li><li>切图<ul><li>就是把 $G(V, E)$切成相互没有连接的k个子图，然后合起来就是完整的图G</li><li>任意两个切图AB之间权重是： $W(A, B) = \sum_{i\in A, j\in B} w_{ij}$</li><li>定义切图cut： $cut(A_1, A_2…A_k) = \frac{1}{2} \sum_{i=1}^k W(A_i, \overline{A_i})$，其中 $\overline{A_i}$其实就是V中A的补集</li><li>直接最小化切图，不是最优的切图</li><li>谱聚类有两种切图方式：RatioCut和cut</li><li>RatioCut：<ul><li>除了最小化切图，还考虑最大化每个子图点的个数</li><li><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/px7w07.png" alt="px7w07"></li><li><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/eTmcmA.png" alt="eTmcmA"></li></ul></li><li>NutCut：<ul><li>Ncut切图和RatioCut切图很类似，但是把Ratiocut的分母|𝐴𝑖|换成𝑣𝑜𝑙(𝐴𝑖). 由于子图样本的个数多并不一定权重就大，我们切图时基于权重也更合我们的目标，因此一般来说Ncut切图优于RatioCut切图</li><li><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/rpF8Yi.png" alt="rpF8Yi"></li><li><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/8nzn56.png" alt="8nzn56"></li></ul></li><li>总结：<ul><li><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/J5TpAk.png" alt="J5TpAk"></li></ul></li></ul></li><li>流程<ul><li>输入：n个样本, 类别k</li><li>根据输入的相似度的衡量方式对样本建图，根据相似图建立邻接矩阵W</li><li>计算出拉普拉斯矩阵L, 其中L=D-W， D为度矩阵</li><li>计算L的最小的k个特征向量u1, u2,…,uk（此步相当于降维),将这些向量组成为n*k维的矩阵U</li><li>将U中的每一行作为一个样本，共n个样本，使用k-means对这n个样本进行聚类</li><li>得到簇划分C(c1,c2,…ck).</li></ul></li><li>缺点是要设置K，和k-means一样</li><li>谱聚类算法的主要优点有：<ul><li>谱聚类只需要数据之间的相似度矩阵，因此对于处理稀疏数据的聚类很有效。这点传统聚类算法比如K-Means很难做到</li><li>由于使用了降维，因此在处理高维数据聚类时的复杂度比传统聚类算法好。</li></ul></li><li>算法的主要缺点有：<ul><li>如果最终聚类的维度非常高，则由于降维的幅度不够，谱聚类的运行速度和最后的聚类效果均不好。</li><li>聚类效果依赖于相似矩阵，不同的相似矩阵得到的最终聚类效果可能很不同。</li></ul></li></ul><h2 id="基于GNN"><a href="#基于GNN" class="headerlink" title="基于GNN"></a>基于GNN</h2><h3 id="基于GCN聚类"><a href="#基于GCN聚类" class="headerlink" title="基于GCN聚类"></a>基于GCN聚类</h3><p>paper： Learning to Cluster Faces on Affinity Graphy(CVPR2019)</p><p>流程：</p><ol><li>将样本点建图(如何建图可以参照前面图聚类算法，实际上有很多种构建方式，主要取决于相似度如何衡量以及如何建边）</li><li>Cluster Proposal: 从前面建好的图中选择出多个sub-graph，也就是proposal，就是子图的概念。主要是为了降低计算消耗，在子图上去做聚类。每一个cluster proposal里的向量数是比较少的。比如说一个包含1M向量的全图可以转化为50K包含20向量的proposal</li><li>Cluster Detection: 将上面的Cluster Proposal利用GCN提取特征后聚类，计算预测类别与gt的差异，评价指标为，$IoU(P)=$和$IoP(P)$</li><li>Cluster Segmentation: 上面那个模块是检测，这个模块是剔除负样本点，评价指标和上面那一步是一样的。使用的loss均为MSE，训练然后梯度下降</li></ol><h3 id="CDP-ECCV2018"><a href="#CDP-ECCV2018" class="headerlink" title="CDP(ECCV2018)"></a>CDP(ECCV2018)</h3><p>是针对人脸识别提出的优化算法，解决的是在大数据集下传统算法聚类性能过差的问题</p><ul><li>是<strong>半监督</strong>方式的</li><li>该算法有3个部分<ul><li>base model, 建一个大的<strong>KNN图</strong></li><li>committe model(决策者模型),多个model, 对大图每一条边，判断是否断开，得到多个子图</li><li>Mediator(融合模型), 根据多个committe的结果来判断两个节点之间的边是保留还是断开，多数投票，最后输出聚类结果</li></ul></li><li>各模块<strong>都用GCN训练</strong>，<strong>非设置阈值</strong></li><li>优点：<ul><li>只探索局部关系，因为它的主要计算量集中在两个节点组成的pairs的关系，而不是整个图的关系，计算效率较高，可以用于大规模数据集</li></ul></li></ul><blockquote><p>We first provide an overview of the proposed approach. Our approach consists of three stages:</p><ol><li><p>Supervised initialization - Given a small portion of labeled data, we separately train the base model and committee members in a fully-supervised manner. More precisely, the base model B and all the N committee members {Ci|i = 1, 2, . . . , N} learn a mapping from image space to feature space Z using labeled data Dl. For the base model, this process can be denoted as the mapping: FB : Dl 􏰉→ Z, and as for committee members: FCi : Dl 􏰉→ Z, i = 1,2,…,N.</p></li><li><p>Consensus-driven propagation - CDP is applied on unlabeled data to se- lect valuable samples and conjecture labels thereon. The framework is shown in Fig. 1. We use the trained models from the first stage to extract deep features for unlabeled data and create k-NN graphs. The “committee” ensures the diver- sity of the graphs. Then a “mediator” network is designed to aggregate diverse opinions in the local structure of k-NN graphs to select meaningful pairs. With the selected pairs, a consensus-driven graph is created on the unlabeled data and nodes are assigned with pseudo labels via our label propagation algorithm.</p></li><li><p>Joint training using labeled and unlabeled data - Finally, we re-train the base model with labeled data, and unlabeled data with pseudo labels, in a multi-task learning framework.</p></li></ol></blockquote><h3 id="DAEGC-IJCAI2019"><a href="#DAEGC-IJCAI2019" class="headerlink" title="DAEGC(IJCAI2019)"></a>DAEGC(IJCAI2019)</h3><p>《Attributed Graph Clustering: A Deep Attentional Embedding Approach》</p><p><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/MGUaZE.png" alt="MGUaZE"></p><p>强调的是goal-directed的embedding方法，用attention based网络捕捉相邻节点之间的importance，并且结合了structure和node content信息作为compact representation。通过graph embedding产生的soft labels进行自监督聚类. 自监督过程和graph embedding优化过程是joint learned and optimized。</p><p>大致上就是先用auto encoder训练，然后用k-means得到一个初始化的cluster center，然后再做自监督的embedding优化，同时更新迭代簇中心位置。</p><p>这篇文章会在后面单独写一个笔记。</p><ul><li>Require:<ul><li>Graph G with n nodes;</li><li>Number of clusters k;</li><li>Number of iterations Iter;</li><li>Target distribution update interval T;</li><li>Clustering Coefficient γ.</li></ul></li><li>Output:<ul><li>k disjoint groups</li></ul></li></ul><p>模型结构：<br><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/MwcbDs.png" alt="MwcbDs"></p><p>实验结果：<br><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/fYsPmB.png" alt="fYsPmB"></p><h3 id="AGC-IJCAI2019"><a href="#AGC-IJCAI2019" class="headerlink" title="AGC(IJCAI2019)"></a>AGC(IJCAI2019)</h3><p>graph-clustering SOTA论文</p><p>《Attributed Graph Clustering via Adaptive Graph Convolution》</p><p><img src="https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/others/in0VDA.png" alt="in0VDA"></p><p>在使用k-order GCN之后，用了谱聚类。问题是谱聚类也要指定k值，所以论文里面是通过实验找到最好的k值…</p><p>和上面的DAEGC挺像的。</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><ol><li>算法不能提前指定类别数</li><li>边的确定<ol><li>ep是merge了pid_ep和photo_ep</li><li>根据ep来建立连接关系，每个1都和2相连，每个2都和3相连</li><li>按照时间顺序连接所有pid</li><li>所有的-1，按照时间顺序，连接前后W个视频，W是窗口大小，设为3</li></ol></li><li>node content X：使用视频的hetu_embedding，128维</li><li>edge weight W: similarity between nodes</li><li>难点：<ol><li>K值无法确定，且会有新增视频进来，K值一直在增加</li><li>如果每次新加入一个节点就得重新train，会很慢</li><li>每次的输入是一整个graph，输出是不同的类，不同用户之间的cluster肯定是不同的。所以要是考虑所有用户，那类别数是没上限的，只能考虑单个用户的图。</li><li>每个用户是一个graph，是不是都得训模型，还是可以有通用的提取特征的模型，直接inference每个用户图</li><li>最后要得到的是node embedding给下游模型做cluster，但是涉及到不同cluster中的节点数不同，有的多有的少。如果在无监督的情况下，想用密度聚类聚在一起，存在1）节点多的cluster召回高的时候，节点少的cluster会被聚成一个类；2）节点少的cluster准确高的时候，节点多的cluster召回低</li></ol></li></ol></div><footer class="post-footer"><div class="post-tags"><a href="/tags/DeepLearning/" rel="tag"><i class="fa fa-tag"></i> DeepLearning</a> <a href="/tags/Clustering/" rel="tag"><i class="fa fa-tag"></i> Clustering</a> <a href="/tags/Graph/" rel="tag"><i class="fa fa-tag"></i> Graph</a> <a href="/tags/GNN/" rel="tag"><i class="fa fa-tag"></i> GNN</a> <a href="/tags/UnstructuredData/" rel="tag"><i class="fa fa-tag"></i> UnstructuredData</a></div><div class="post-nav"><div class="post-nav-item"><a href="/MachineLearning/2021-04-26-allennlp-notes-2" rel="prev" title="AllenNLP框架学习笔记（二）"><i class="fa fa-chevron-left"></i> AllenNLP框架学习笔记（二）</a></div><div class="post-nav-item"><a href="/Papers/2021-05-20-gnn-survey-IEEE-2021" rel="next" title="论文笔记 | A Comprehensive Survey on Graph Neural Networks">论文笔记 | A Comprehensive Survey on Graph Neural Networks <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comment-button-group"><a class="btn comment-button disqus">disqus</a> <a class="btn comment-button gitalk">gitalk</a></div><div class="comment-position disqus"><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div></div></div><div class="comment-position gitalk"><div class="comments" id="gitalk-container"></div></div><script>(function() {
          let commentButton = document.querySelectorAll('.comment-button');
            commentButton.forEach(element => {
            let commentClass = element.classList[2];
            element.addEventListener('click', () => {
              commentButton.forEach(active => active.classList.toggle('active', active === element));
              document.querySelectorAll('.comment-position').forEach(active => active.classList.toggle('active', active.classList.contains(commentClass)));
              if (CONFIG.comments.storage) {
                localStorage.setItem('comments_active', commentClass);
              }
            });
          });
          let { activeClass } = CONFIG.comments;
          if (CONFIG.comments.storage) {
            activeClass = localStorage.getItem('comments_active') || activeClass;
          }
          if (activeClass) {
            let activeButton = document.querySelector(`.comment-button.${activeClass}`);
            if (activeButton) {
              activeButton.click();
            }
          }
        })();</script><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Haniel Farnsworth</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">Symbols count total: </span><span title="Symbols count total">472k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">Reading time total &asymp;</span> <span title="Reading time total">19:39</span></div><div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a> & <a href="https://github.com/next-geek/next-geek" class="theme-link" rel="external nofollow noopener noreferrer" target="_blank">Next-geek</a></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)}()</script><script src="/js/local-search.js"></script><script>function loadCount(){var d=document,n=d.createElement("script");n.src="https://hanielxx.disqus.com/count.js",n.id="dsq-count-scr",(d.head||d.body).appendChild(n)}window.addEventListener("load",loadCount,!1)</script><script>var disqus_config = function() {
    this.page.url = "https://hanielxx.com/MachineLearning/2021-05-09-gnn-graph-clustering";
    this.page.identifier = "MachineLearning/2021-05-09-gnn-graph-clustering.html";
    this.page.title = "GNN和图聚类";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://hanielxx.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '27e3eba13ef3780f492b',
      clientSecret: '4e28d0b26bbf1501e220a7d94b983aec4e4c11df',
      repo        : 'CommentsRepo',
      owner       : 'HanielF',
      admin       : ['HanielF'],
      id          : '5650c9caba358871eecda4c615dee89e',
        language: 'en',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});</script></body></html>